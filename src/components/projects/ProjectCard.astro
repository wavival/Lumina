---
import Button from "../ui/Button.astro";
import Icon from "../ui/Icon.astro";

interface Links { site?: string; github?: string; behance?: string }
const {
  size = "small",
  title,
  cover,
  href,
  links = {},
  alt = `${title} — portada`,
} = Astro.props as {
  size?: "small" | "large";
  title: string;
  cover: string;
  href: string;
  links?: Links;
  alt?: string;
};

const isSmall = size === "small";
const moreLabel = `Saber más sobre ${title}`;
---

<article
  data-size={size}
  itemscope
  itemtype="https://schema.org/CreativeWork"
  aria-labelledby={`lab-${title}-heading`}
  class:list={[
    "inline-flex flex-col justify-start items-start overflow-hidden bg-card shadow-ui",
    isSmall ? "w-80 h-96 p-3 gap-4" : "w-[475px] h-[554px] p-4 gap-4",
  ]}
>
  <meta itemprop="name" content={title} />

  <figure class="self-stretch flex-1 radius-2xl overflow-hidden">
    <a
      href={href}
      itemprop="url"
      aria-label={moreLabel}
      class="block radius-2xl focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ui-link"
    >
      <img
        src={cover}
        alt={alt}
        itemprop="image"
        loading="lazy"
        decoding="async"
        width="800" height="600"
        class="w-full h-full object-cover"
      />
    </a>
    <figcaption class="sr-only">{title}</figcaption>
  </figure>

  <!-- Footer -->
  <footer class="self-stretch inline-flex justify-between items-center">
    <h3
      id={`lab-${title}-heading`}
      class="heading-3 truncate"
    >
      <a
        href={href}
        class="hover:underline rounded focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ui-link"
      >
        {title}
      </a>
    </h3>

    <!-- Acciones -->
    <nav aria-label={`Enlaces de ${title}`}>
      <ul role="list" class="flex justify-center items-center gap-1.5">
        {isSmall ? (
          <>
            <!-- Small: “Saber más” como icono -->
            <li role="listitem">
              <a
                href={href}
                aria-label={moreLabel}
                class="p-2 radius-2xl hover:bg-ui-hover/15 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ui-link"
              >
                <Icon src="/icons/ui/link.svg" size="md" class="text-accent-link" />
              </a>
            </li>
            {links.github && (
              <li role="listitem">
                <a
                  href={links.github}
                  target="_blank" rel="noopener noreferrer"
                  aria-label={`GitHub de ${title}`}
                  class="p-2 radius-2xl hover:bg-ui-hover/15 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ui-link"
                >
                  <Icon src="/icons/brands/github.svg" size="md" class="text-accent-link" />
                </a>
              </li>
            )}
            {links.behance && (
              <li role="listitem">
                <a
                  href={links.behance}
                  target="_blank" rel="noopener noreferrer"
                  aria-label={`Behance de ${title}`}
                  class="p-2 radius-2xl hover:bg-ui-hover/15 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ui-link"
                >
                  <Icon src="/icons/brands/behance.svg" size="md" class="text-accent-link" />
                </a>
              </li>
            )}
          </>
        ) : (
          <>
            <!-- Large: botón “SABER MÁS” + iconos -->
            <li role="listitem" class="mr-1.5">
              <Button
                href={href}
                variant="secondary"
                size="sm"
                class="btn-text-sm"
                aria-label={moreLabel}
              >
                saber más
              </Button>
            </li>
            {links.github && (
              <li role="listitem">
                <a
                  href={links.github}
                  target="_blank" rel="noopener noreferrer"
                  aria-label={`GitHub de ${title}`}
                  class="p-2 radius-2xl hover:bg-ui-hover/15 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ui-link"
                >
                  <Icon src="/icons/brands/github.svg" size="md" class="text-accent-link" />
                </a>
              </li>
            )}
            {links.behance && (
              <li role="listitem">
                <a
                  href={links.behance}
                  target="_blank" rel="noopener noreferrer"
                  aria-label={`Behance de ${title}`}
                  class="p-2 radius-2xl hover:bg-ui-hover/15 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ui-link"
                >
                  <Icon src="/icons/brands/behance.svg" size="md" class="text-accent-link" />
                </a>
              </li>
            )}
          </>
        )}
      </ul>
    </nav>
  </footer>
</article>